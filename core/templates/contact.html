{% extends 'base.html' %}
{% block title %}
    <title>Contact Us - Novatrix Digital</title>
{% endblock title %}
{% block css %}
    <style>
      .contact-container {
        max-width: 1200px;
        margin: 0 auto;
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 4rem;
      }

      .contact-info {
        padding-top: 2rem;
      }

      .contact-info h2 {
        font-size: 2.5rem;
        margin-bottom: 1.5rem;
      }

      .contact-info p {
        font-size: 1.1rem;
        color: var(--slate);
        line-height: 1.8;
        margin-bottom: 2rem;
      }

      .contact-methods {
        display: flex;
        flex-direction: column;
        gap: 2rem;
        margin-top: 3rem;
      }

      .contact-method {
        display: flex;
        align-items: flex-start;
        gap: 1.5rem;
      }

      .method-icon {
        width: 50px;
        height: 50px;
        background: var(--light);
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 1px;
        flex-shrink: 0;
      }

      .method-icon svg {
        width: 24px;
        height: 24px;
        stroke: var(--graphite);
      }

      .method-content h3 {
        font-size: 1.2rem;
        margin-bottom: 0.5rem;
      }

      .method-content p {
        color: var(--slate);
        margin: 0;
        font-size: 1rem;
      }

      .method-content a {
        color: var(--cyan);
        text-decoration: none;
      }

      .method-content a:hover {
        text-decoration: underline;
      }

      .contact-form {
        background: var(--white);
        border: 1px solid var(--silver);
        padding: 3rem;
      }

      .form-group {
        margin-bottom: 1.5rem;
      }

      .form-group label {
        display: block;
        margin-bottom: 0.5rem;
        font-weight: 500;
        letter-spacing: 0.3px;
        font-size: 0.95rem;
      }

      .form-group input,
      .form-group select,
      .form-group textarea {
        width: 100%;
        padding: 0.9rem 1.2rem;
        border: 1px solid var(--silver);
        background: var(--light);
        font-family: "Outfit", sans-serif;
        font-size: 1rem;
        transition: all 0.3s ease;
        border-radius: 1px;
      }

      .form-group input:focus,
      .form-group select:focus,
      .form-group textarea:focus {
        outline: none;
        border-color: var(--cyan);
        background: var(--white);
      }

      .form-group textarea {
        resize: vertical;
        min-height: 140px;
      }

      .form-submit {
        width: 100%;
        padding: 1.2rem;
        background: var(--graphite);
        color: var(--white);
        border: none;
        font-size: 1rem;
        font-weight: 600;
        letter-spacing: 0.5px;
        cursor: pointer;
        transition: all 0.3s ease;
        border-radius: 1px;
      }

      .form-submit:hover {
        background: var(--cyan);
        color: var(--graphite);
      }

      .error-message {
        color: #dc3545;
        font-size: 0.875rem;
        margin-top: 0.25rem;
        display: none;
      }

      .form-group.error input,
      .form-group.error select,
      .form-group.error textarea {
        border-color: #dc3545;
      }

      .form-group.error .error-message {
        display: block;
      }

      .social-section {
        background: var(--light);
        text-align: center;
      }

      .social-links {
        display: flex;
        justify-content: center;
        gap: 2rem;
        margin-top: 2rem;
      }

      .social-link {
        width: 60px;
        height: 60px;
        background: var(--white);
        border: 1px solid var(--silver);
        display: flex;
        align-items: center;
        justify-content: center;
        text-decoration: none;
        color: var(--graphite);
        transition: all 0.3s ease;
      }

      .social-link:hover {
        background: var(--graphite);
        color: var(--white);
        border-color: var(--graphite);
        transform: translateY(-4px);
      }

      @media (max-width: 1024px) {
        .contact-container {
          grid-template-columns: 1fr;
          gap: 3rem;
        }
      }
    </style>
{% endblock css %}
{% block content %}

    <!-- Page Header -->
    <div class="page-header">
      <div class="container">
        <h1>Let's Build Something Great</h1>
        <p>
          Request a free consultation and see how we can transform your digital
          presence.
        </p>
        {% if messages %}
          <div style="margin-top: 1.5rem;">
            {% for message in messages %}
              <div style="background: #00d9ff; color: #1a1a1a; padding: 1rem; border-radius: 2px; font-weight: 500;">
                {{ message }}
              </div>
            {% endfor %}
          </div>
        {% endif %}
      </div>
    </div>

    <!-- Contact Section -->
    <section>
      <div class="container">
        <div class="contact-container">
          <div class="contact-info animate-on-scroll">
            <h2>Get in Touch</h2>
            <p>
              Whether you need a new website, want to discuss maintenance plans,
              or just have questions about our services, we're here to help.
              Fill out the form and we'll get back to you within 24 hours.
            </p>
            <p>
              No sales pressure. No commitment required. Just a genuine
              conversation about your needs and how we might be able to help.
            </p>

            <div class="contact-methods">
              <div class="contact-method">
                <div class="method-icon">
                  <svg
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    strokeWidth="2"
                  >
                    <path
                      d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"
                    />
                    <polyline points="22,6 12,13 2,6" />
                  </svg>
                </div>
                <div class="method-content">
                  <h3>Email</h3>
                  <p>
                    <a href="mailto:contact@novatrixdigital.com"
                      >contact@novatrixdigital.com</a
                    >
                  </p>
                </div>
              </div>

              <div class="contact-method">
                <div class="method-icon">
                  <svg
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    strokeWidth="2"
                  >
                    <path
                      d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"
                    />
                  </svg>
                </div>
                <div class="method-content">
                  <h3>Phone</h3>
                  <p><a href="tel:+970592049632">+970 592 049 632</a></p>
                </div>
              </div>

              <div class="contact-method">
                <div class="method-icon">
                  <svg
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    strokeWidth="2"
                  >
                    <circle cx="12" cy="12" r="10" />
                    <path d="M12 6v6l4 2" />
                  </svg>
                </div>
                <div class="method-content">
                  <h3>Response Time</h3>
                  <p>Within 24 hours on business days</p>
                </div>
              </div>
            </div>
          </div>

          <form
            class="contact-form animate-on-scroll"
            method="post"
            id="contactForm"
            onsubmit="return validateForm(event)"
          >
          {% csrf_token %}
            <div class="form-group" id="group-full-name">
              <label>{{ form.full_name.label }}</label>
              {{ form.full_name }}
              <span class="error-message" id="error-full-name"></span>
            </div>

            <div class="form-group" id="group-company-name">
              <label>{{ form.company_name.label }}</label>
              {{ form.company_name }}
              <span class="error-message" id="error-company-name"></span>
            </div>

            <div class="form-group" id="group-email">
              <label>{{ form.email.label }}</label>
              {{ form.email }}
              <span class="error-message" id="error-email"></span>
            </div>

            <div class="form-group" id="group-phone-number">
              <label>{{ form.phone_number.label }}</label>
              <input type="tel" name="phone_number" id="id_phone_number" inputmode="numeric" placeholder="1234567890" maxlength="15">
              <span class="error-message" id="error-phone-number"></span>
            </div>

            <div class="form-group" id="group-current-website">
              <label>{{ form.current_website.label }}</label>
              {{ form.current_website }}
              <span class="error-message" id="error-current-website"></span>
            </div>

            <div class="form-group" id="group-service-needed">
              <label>{{ form.service_needed.label }}</label>
              {{ form.service_needed }}
              <span class="error-message" id="error-service-needed"></span>
            </div>

            <div class="form-group" id="group-project-description">
              <label>{{ form.project_description.label }}</label>
              {{ form.project_description }}
              <span class="error-message" id="error-project-description"></span>
            </div>

            <button type="submit" class="form-submit">Request Free Demo</button>
          </form>
        </div>
      </div>
    </section>

    <script>
      function validateForm(event) {
        event.preventDefault();
        
        // Clear previous errors
        document.querySelectorAll('.form-group').forEach(group => {
          group.classList.remove('error');
        });
        document.querySelectorAll('.error-message').forEach(msg => {
          msg.textContent = '';
        });

        let isValid = true;
        const form = document.getElementById('contactForm');

        // Full Name validation
        const fullName = form.querySelector('[name="full_name"]');
        if (!fullName.value.trim()) {
          showError('full-name', 'Full name is required');
          isValid = false;
        } else if (fullName.value.trim().length < 2) {
          showError('full-name', 'Full name must be at least 2 characters');
          isValid = false;
        }

        // Company Name validation
        const companyName = form.querySelector('[name="company_name"]');
        if (!companyName.value.trim()) {
          showError('company-name', 'Company name is required');
          isValid = false;
        }

        // Email validation
        const email = form.querySelector('[name="email"]');
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        if (!email.value.trim()) {
          showError('email', 'Email address is required');
          isValid = false;
        } else if (!emailRegex.test(email.value)) {
          showError('email', 'Please enter a valid email address');
          isValid = false;
        }

        // Phone Number validation (up to 15 characters including + symbol)
        const phoneNumber = form.querySelector('[name="phone_number"]');
        if (!phoneNumber.value.trim()) {
          showError('phone-number', 'Phone number is required');
          isValid = false;
        } else if (phoneNumber.value.trim().length > 15) {
          showError('phone-number', 'Phone number must be up to 15 characters');
          isValid = false;
        } else if (!/^[\d+]+$/.test(phoneNumber.value.trim())) {
          showError('phone-number', 'Phone number can only contain digits and + symbol');
          isValid = false;
        }

        // Current Website validation (optional but if provided, should be valid URL)
        const currentWebsite = form.querySelector('[name="current_website"]');
        if (currentWebsite.value.trim()) {
          try {
            new URL(currentWebsite.value);
          } catch (_) {
            showError('current-website', 'Please enter a valid URL (e.g., https://example.com)');
            isValid = false;
          }
        }

        // Service needed validation
        const serviceNeeded = form.querySelector('[name="service_needed"]');
        if (!serviceNeeded.value) {
          showError('service-needed', 'Please select a service');
          isValid = false;
        }

        // Project description validation
        const projectDescription = form.querySelector('[name="project_description"]');
        if (!projectDescription.value.trim()) {
          showError('project-description', 'Project description is required');
          isValid = false;
        } else if (projectDescription.value.trim().length < 10) {
          showError('project-description', 'Please provide more details (at least 10 characters)');
          isValid = false;
        }

        if (isValid) {
          form.submit();
        } else {
          // Scroll to first error
          const firstError = document.querySelector('.form-group.error');
          if (firstError) {
            firstError.scrollIntoView({ behavior: 'smooth', block: 'center' });
          }
        }

        return false;
      }

      function showError(fieldName, message) {
        const group = document.getElementById('group-' + fieldName);
        const errorMsg = document.getElementById('error-' + fieldName);
        
        if (group && errorMsg) {
          group.classList.add('error');
          errorMsg.textContent = message;
        }
      }

      // Real-time validation on blur
      document.addEventListener('DOMContentLoaded', function() {
        const form = document.getElementById('contactForm');
        
        // Restrict phone number to up to 15 characters (digits and +)
        const phoneField = form.querySelector('[name="phone_number"]');
        if (phoneField) {
          phoneField.addEventListener('input', function(e) {
            // Remove any characters that aren't digits or +
            this.value = this.value.replace(/[^0-9+]/g, '');
            // Limit to 15 characters
            if (this.value.length > 15) {
              this.value = this.value.slice(0, 15);
            }
          });
          
          phoneField.addEventListener('keypress', function(e) {
            const char = String.fromCharCode(e.which);
            // Only allow digits and + symbol
            if (!/[0-9+]/.test(char)) {
              e.preventDefault();
            }
            // Prevent input if already at 15 characters
            if (this.value.length >= 15) {
              e.preventDefault();
            }
          });
        }
        
        form.querySelectorAll('input, select, textarea').forEach(field => {
          field.addEventListener('blur', function() {
            const fieldName = this.name.replace('_', '-');
            const group = document.getElementById('group-' + fieldName);
            
            if (group && group.classList.contains('error')) {
              // Re-validate this specific field
              validateForm(new Event('submit'));
            }
          });

          // Clear error on input
          field.addEventListener('input', function() {
            const fieldName = this.name.replace('_', '-');
            const group = document.getElementById('group-' + fieldName);
            const errorMsg = document.getElementById('error-' + fieldName);
            
            if (group && group.classList.contains('error')) {
              group.classList.remove('error');
              if (errorMsg) errorMsg.textContent = '';
            }
          });
        });
      });
    </script>
{% endblock %}
